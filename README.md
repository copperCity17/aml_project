# Food Image Classification

This project is about food image classification and our goal is to design and implement a feasible and creative architecture. First, we experiemted with developing a CNN and trained from scratch. However, as the model performance was stuck at 35%, we decided to leverage other pretrained models for transfer learning, including VGG16, Xception, InceptionV16, and MobileNetV2. Image data augmentation was also applied to the learning. After training several epochs to achieve a certain accuracy rate, an ensemble method is used to average out the predictions. This ensemble method is performed in [transfer_learning.ipynb](https://github.com/copperCity17/aml_project/blob/main/transfer_learning.ipynb).

Before training is done, however, the ensemble model is optimised by removing watermarks from images in both the train and test sets. To do this, a cycleGAN is developed, which is a combination of two GANs: hence there are two "generators" and two "discriminators". The first generator, G_w, makes watermarked images from normal images. The second generator model, G_n, generates normal images from watermarked images. After training the cycleGAN, this generator model, G_n, is used to remove watermarks. Not only does the notebook [train-watermark-removal.ipynb](https://github.com/copperCity17/aml_project/blob/main/train-watermark-removal.ipynb) develop this cycleGAN, but it also scrapes images from online for training the cycleGAN.

After the cycleGAN has been trained in train_watermark_removal.ipynb, then next step is to apply the cycleGAN to the train and test sets of food images and remove watermarks. As mentioned before, only the generator G_n that translates watermarked images to unwatermarked images, is necessary for this. Removing watermarks is done the notebook [remove-watermarks-from-food.ipynb](https://github.com/copperCity17/aml_project/blob/main/remove-watermarks-from-food.ipynb). 
